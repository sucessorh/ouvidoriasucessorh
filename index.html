<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canal de Ouvidoria - Sucesso RH</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Poppins and Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Styles and Tailwind Config -->
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply bg-slate-50 font-['Inter'] text-slate-700;
            }
            h1, h2, h3 {
                @apply font-['Poppins'];
            }
            /* Custom Scrollbar */
            ::-webkit-scrollbar {
                width: 8px;
            }
            ::-webkit-scrollbar-track {
                background: #f1f5f9;
            }
            ::-webkit-scrollbar-thumb {
                background: #1E63B3;
                border-radius: 10px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: #0B2D59;
            }
        }
        @layer utilities {
            .bg-gradient-sucesso {
                @apply bg-gradient-to-r from-[#0B2D59] to-[#1E63B3] text-transparent bg-clip-text;
            }
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            }
            /* Animation for Carousel */
            .animate-scroll {
                animation: scroll 40s linear infinite;
            }
            @keyframes scroll {
                0% { transform: translateX(0); }
                100% { transform: translateX(calc(-250px * 7)); }
            }
            /* Animations for scroll reveal */
            .reveal {
                opacity: 0;
                transform: translateY(30px);
                transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            }
            .reveal.visible {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#0B2D59',
                        'secondary': '#1E63B3',
                        'light': '#f8fafc',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'display': ['Poppins', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="overflow-x-hidden">

    <!-- ======================================================= -->
    <!-- =================== PUBLIC VIEW ======================= -->
    <!-- ======================================================= -->
    <div id="ouvidoria-view">
        <!-- Header -->
        <header class="fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-sm shadow-md z-50 transition-all duration-300">
            <div class="container mx-auto px-6 py-3 flex justify-between items-center">
                <img src="https://i.postimg.cc/wv5wQfzB/logo-sucesso-rh.png" alt="Logo Sucesso RH" class="h-10 md:h-12">
                <nav class="hidden md:flex items-center gap-8">
                    <a href="#sobre" class="text-slate-600 hover:text-secondary transition-colors">Sobre o Canal</a>
                    <a href="#como-funciona" class="text-slate-600 hover:text-secondary transition-colors">Como Funciona</a>
                    <a href="#faq" class="text-slate-600 hover:text-secondary transition-colors">FAQ</a>
                </nav>
                <div>
                    <button id="open-login-modal-btn" class="text-sm text-slate-500 hover:text-primary transition-colors">Acesso Restrito</button>
                </div>
            </div>
        </header>

        <main>
            <!-- Hero Section -->
            <section id="hero" class="relative pt-32 pb-20 md:pt-48 md:pb-32 text-center bg-light overflow-hidden">
                <div class="absolute inset-0 bg-cover bg-center opacity-15" style="background-image: url('https://i.postimg.cc/x8B9HCTS/busy-woman-doing-many-things-same-time.jpg');"></div>
                <div class="container mx-auto px-6 relative z-10">
                    <h1 class="text-4xl md:text-6xl font-extrabold bg-gradient-sucesso text-shadow">Bem-vindo à Ouvidoria Sucesso RH</h1>
                    <p class="mt-6 max-w-3xl mx-auto text-lg text-slate-600">Um espaço seguro e confidencial para você se manifestar. Sua voz é fundamental para construirmos um ambiente de trabalho cada vez melhor.</p>
                    <button id="open-report-modal-btn" class="mt-10 px-8 py-4 bg-secondary text-white font-bold rounded-lg shadow-lg hover:bg-primary hover:scale-105 transform transition-all duration-300">
                        Fazer um Relato
                    </button>
                </div>
            </section>

            <!-- About Section -->
            <section id="sobre" class="bg-primary text-white py-20">
                <div class="container mx-auto px-6 text-center reveal">
                    <i data-lucide="message-circle-heart" class="w-16 h-16 mx-auto text-secondary"></i>
                    <h2 class="text-3xl md:text-4xl font-bold mt-4">Um Canal Aberto para Você</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-slate-300">A Ouvidoria da Sucesso RH é uma ferramenta estratégica de gestão que acolhe suas manifestações — sejam elas denúncias, reclamações, sugestões ou elogios. Nosso objetivo é fortalecer a ética, a transparência e a confiança em nossas relações.</p>
                </div>
            </section>

            <!-- Commitments Section -->
            <section id="compromissos" class="py-20 bg-light">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 bg-gradient-sucesso reveal">Nosso Compromisso com Você</h2>
                    <div class="grid md:grid-cols-3 gap-8">
                        <!-- Card 1: Sigilo -->
                        <div class="bg-primary text-white p-8 rounded-xl shadow-lg text-center reveal transform hover:-translate-y-2 transition-transform duration-300">
                            <i data-lucide="shield-off" class="w-12 h-12 mx-auto text-secondary"></i>
                            <h3 class="text-2xl font-bold mt-4">Sigilo Absoluto</h3>
                            <p class="mt-2 text-slate-300">Garantimos a confidencialidade total da sua identidade. O relato pode ser feito de forma 100% anônima.</p>
                        </div>
                        <!-- Card 2: Imparcialidade -->
                        <div class="bg-primary text-white p-8 rounded-xl shadow-lg text-center reveal transform hover:-translate-y-2 transition-transform duration-300" style="transition-delay: 150ms;">
                            <i data-lucide="scale" class="w-12 h-12 mx-auto text-secondary"></i>
                            <h3 class="text-2xl font-bold mt-4">Análise Imparcial</h3>
                            <p class="mt-2 text-slate-300">Todos os relatos são apurados com isenção, profissionalismo e por uma equipe especializada e independente.</p>
                        </div>
                        <!-- Card 3: Resposta -->
                        <div class="bg-primary text-white p-8 rounded-xl shadow-lg text-center reveal transform hover:-translate-y-2 transition-transform duration-300" style="transition-delay: 300ms;">
                            <i data-lucide="user-check" class="w-12 h-12 mx-auto text-secondary"></i>
                            <h3 class="text-2xl font-bold mt-4">Resposta Oportuna</h3>
                            <p class="mt-2 text-slate-300">Comprometemo-nos a dar o devido tratamento a cada manifestação e, quando identificado, um retorno ao manifestante.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Awareness Pills Carousel -->
            <section id="pilulas" class="py-20 bg-light overflow-hidden">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 bg-gradient-sucesso reveal">Pílulas de Conscientização</h2>
                </div>
                <div class="relative w-full overflow-hidden group">
                    <div class="flex animate-scroll group-hover:[animation-play-state:paused]">
                        <!-- Cloned slides for seamless loop -->
                        <div class="flex">
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="shield-check" class="text-primary"></i><h4 class="font-bold">Respeito é a Base</h4></div> <p class="text-sm mt-2 text-slate-600">O respeito mútuo é o alicerce de um ambiente de trabalho saudável e produtivo.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="message-square-x" class="text-primary"></i><h4 class="font-bold">Assédio Moral</h4></div> <p class="text-sm mt-2 text-slate-600">Expor alguém a situações humilhantes e constrangedoras de forma repetitiva.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="hand-heart" class="text-primary"></i><h4 class="font-bold">Assédio Sexual</h4></div> <p class="text-sm mt-2 text-slate-600">Constrangimento com conotação sexual no ambiente de trabalho.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="megaphone" class="text-primary"></i><h4 class="font-bold">Sua Atitude Importa</h4></div> <p class="text-sm mt-2 text-slate-600">Pequenos gestos de gentileza e colaboração transformam o clima organizacional.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="scale" class="text-primary"></i><h4 class="font-bold">Hierarquia e Assédio</h4></div> <p class="text-sm mt-2 text-slate-600">A relação de poder não dá o direito de desrespeitar ou humilhar.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="lightbulb" class="text-primary"></i><h4 class="font-bold">Não é Assédio</h4></div> <p class="text-sm mt-2 text-slate-600">Feedbacks construtivos e cobrança de metas não configuram assédio.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="trending-up" class="text-primary"></i><h4 class="font-bold">Crescimento Contínuo</h4></div> <p class="text-sm mt-2 text-slate-600">Seu relato nos ajuda a identificar pontos de melhoria e a evoluir.</p> </div>
                        </div>
                        <!-- Original slides -->
                        <div class="flex">
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="shield-check" class="text-primary"></i><h4 class="font-bold">Respeito é a Base</h4></div> <p class="text-sm mt-2 text-slate-600">O respeito mútuo é o alicerce de um ambiente de trabalho saudável e produtivo.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="message-square-x" class="text-primary"></i><h4 class="font-bold">Assédio Moral</h4></div> <p class="text-sm mt-2 text-slate-600">Expor alguém a situações humilhantes e constrangedoras de forma repetitiva.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="hand-heart" class="text-primary"></i><h4 class="font-bold">Assédio Sexual</h4></div> <p class="text-sm mt-2 text-slate-600">Constrangimento com conotação sexual no ambiente de trabalho.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="megaphone" class="text-primary"></i><h4 class="font-bold">Sua Atitude Importa</h4></div> <p class="text-sm mt-2 text-slate-600">Pequenos gestos de gentileza e colaboração transformam o clima organizacional.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="scale" class="text-primary"></i><h4 class="font-bold">Hierarquia e Assédio</h4></div> <p class="text-sm mt-2 text-slate-600">A relação de poder não dá o direito de desrespeitar ou humilhar.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="lightbulb" class="text-primary"></i><h4 class="font-bold">Não é Assédio</h4></div> <p class="text-sm mt-2 text-slate-600">Feedbacks construtivos e cobrança de metas não configuram assédio.</p> </div>
                            <div class="flex-shrink-0 w-[250px] mx-4 bg-white p-6 rounded-lg shadow-md border-t-4 border-secondary"> <div class="flex items-center gap-3"><i data-lucide="trending-up" class="text-primary"></i><h4 class="font-bold">Crescimento Contínuo</h4></div> <p class="text-sm mt-2 text-slate-600">Seu relato nos ajuda a identificar pontos de melhoria e a evoluir.</p> </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- How it Works Section -->
            <section id="como-funciona" class="bg-primary text-white py-20">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 reveal">Como Funciona?</h2>
                    <div class="grid md:grid-cols-3 gap-8 text-center relative">
                        <!-- Dashed line for desktop -->
                        <div class="hidden md:block absolute top-1/2 left-0 w-full h-px -translate-y-1/2">
                            <svg width="100%" height="2"><line x1="0" y1="1" x2="100%" y2="1" stroke="#1E63B3" stroke-width="2" stroke-dasharray="10 10"/></svg>
                        </div>
                        <!-- Step 1 -->
                        <div class="relative z-10 reveal">
                            <div class="w-20 h-20 bg-secondary rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-4 border-4 border-primary">1</div>
                            <h3 class="text-xl font-bold">Faça seu Relato</h3>
                            <p class="mt-2 text-slate-300">Clique no botão "Fazer um Relato", preencha o formulário com o máximo de detalhes. Você pode se identificar ou permanecer anônimo.</p>
                        </div>
                        <!-- Step 2 -->
                        <div class="relative z-10 reveal" style="transition-delay: 150ms;">
                            <div class="w-20 h-20 bg-secondary rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-4 border-4 border-primary">2</div>
                            <h3 class="text-xl font-bold">Análise e Apuração</h3>
                            <p class="mt-2 text-slate-300">A Ouvidoria recebe seu relato, analisa as informações e inicia o processo de apuração com total sigilo e imparcialidade.</p>
                        </div>
                        <!-- Step 3 -->
                        <div class="relative z-10 reveal" style="transition-delay: 300ms;">
                            <div class="w-20 h-20 bg-secondary rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-4 border-4 border-primary">3</div>
                            <h3 class="text-xl font-bold">Ação e Retorno</h3>
                            <p class="mt-2 text-slate-300">As medidas cabíveis são tomadas e, se você se identificou, receberá um retorno sobre o andamento e a conclusão do seu caso.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section id="faq" class="py-20 bg-light">
                <div class="container mx-auto px-6 max-w-4xl">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 bg-gradient-sucesso reveal">Perguntas Frequentes</h2>
                    <div class="space-y-4">
                        <details class="group bg-white p-6 rounded-lg shadow-sm reveal">
                            <summary class="flex justify-between items-center font-semibold cursor-pointer text-lg text-primary">
                                Preciso me identificar para fazer um relato?
                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <p class="text-slate-600 mt-4">Não. A identificação é opcional. Garantimos o anonimato para quem preferir não se identificar, assegurando a mesma seriedade na apuração do relato.</p>
                        </details>
                        <details class="group bg-white p-6 rounded-lg shadow-sm reveal">
                            <summary class="flex justify-between items-center font-semibold cursor-pointer text-lg text-primary">
                                Que tipo de situação posso relatar?
                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <p class="text-slate-600 mt-4">Qualquer situação que viole nosso código de conduta, políticas internas ou a legislação vigente. Isso inclui assédio moral ou sexual, discriminação, fraude, corrupção, conflito de interesses, ou qualquer outra prática antiética.</p>
                        </details>
                        <details class="group bg-white p-6 rounded-lg shadow-sm reveal">
                            <summary class="flex justify-between items-center font-semibold cursor-pointer text-lg text-primary">
                                Sofrerei alguma retaliação se fizer uma denúncia?
                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <p class="text-slate-600 mt-4">A Sucesso RH tem uma política de tolerância zero contra retaliações. Qualquer ato de intimidação ou retaliação contra quem, de boa-fé, faz um relato é considerado uma falta grave e será devidamente punido.</p>
                        </details>
                         <details class="group bg-white p-6 rounded-lg shadow-sm reveal">
                            <summary class="flex justify-between items-center font-semibold cursor-pointer text-lg text-primary">
                                Como acompanho meu relato?
                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <p class="text-slate-600 mt-4">Ao enviar seu relato, um número de protocolo será gerado. Guarde este número. Se você se identificou, a Ouvidoria entrará em contato para dar seguimento. Se o relato foi anônimo, a apuração ocorrerá internamente.</p>
                        </details>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-primary text-white">
            <div class="container mx-auto px-6 py-8 text-center">
                <p class="text-slate-300">&copy; 2025 Sucesso RH. Todos os direitos reservados.</p>
                <div class="flex justify-center gap-6 mt-4">
                    <a href="#" class="text-slate-400 hover:text-white transition-colors"><i data-lucide="facebook" class="w-6 h-6"></i></a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors"><i data-lucide="instagram" class="w-6 h-6"></i></a>
                    <a href="#" class="text-slate-400 hover:text-white transition-colors"><i data-lucide="linkedin" class="w-6 h-6"></i></a>
                </div>
            </div>
        </footer>
    </div>

    <!-- ======================================================= -->
    <!-- =================== ADMIN PANEL ======================= -->
    <!-- ======================================================= -->
    <div id="admin-view" class="hidden min-h-screen bg-slate-100 p-4 sm:p-6 md:p-8">
        <div class="max-w-7xl mx-auto">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-primary">Painel do Ouvidor</h1>
                <button id="logout-btn" class="flex items-center gap-2 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors">
                    <i data-lucide="log-out" class="w-5 h-5"></i>
                    Sair
                </button>
            </div>

            <!-- Filters -->
            <div class="bg-white p-4 rounded-lg shadow-md mb-6 flex flex-col sm:flex-row gap-4 items-center">
                <div class="relative w-full sm:w-1/2">
                    <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5"></i>
                    <input type="text" id="search-input" placeholder="Buscar por palavra-chave..." class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                </div>
                <div class="relative w-full sm:w-1/2">
                    <i data-lucide="filter" class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5"></i>
                    <select id="status-filter" class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg appearance-none focus:ring-2 focus:ring-secondary focus:border-transparent">
                        <option value="">Todos os Status</option>
                        <option value="Recebido">Recebido</option>
                        <option value="Em Análise">Em Análise</option>
                        <option value="Concluído">Concluído</option>
                    </select>
                    <i data-lucide="chevron-down" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5 pointer-events-none"></i>
                </div>
            </div>

            <!-- Reports Table -->
            <div class="bg-white rounded-lg shadow-md overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-slate-200">
                        <tr>
                            <th class="p-4 font-semibold text-slate-600">Protocolo</th>
                            <th class="p-4 font-semibold text-slate-600">Tipo</th>
                            <th class="p-4 font-semibold text-slate-600">Data</th>
                            <th class="p-4 font-semibold text-slate-600">Status</th>
                            <th class="p-4 font-semibold text-slate-600">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="reports-table-body">
                        <!-- Rows will be inserted by JS -->
                        <tr>
                            <td colspan="5" class="p-8 text-center text-slate-500">
                                Carregando relatos...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <!-- ======================================================= -->
    <!-- ======================= MODALS ======================== -->
    <!-- ======================================================= -->

    <!-- Report Modal -->
    <div id="report-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-8 relative transform transition-all scale-95 opacity-0">
            <button class="absolute top-4 right-4 text-slate-500 hover:text-red-500" onclick="toggleModal('report-modal')">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h2 class="text-2xl font-bold text-primary mb-6">Fazer um Relato</h2>
            <form id="report-form">
                <div class="space-y-4">
                    <div>
                        <label for="report-type" class="block font-semibold mb-1 text-slate-700">Tipo de Manifestação <span class="text-red-500">*</span></label>
                        <select id="report-type" required class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                            <option value="" disabled selected>Selecione o tipo</option>
                            <option value="Denúncia">Denúncia</option>
                            <option value="Reclamação">Reclamação</option>
                            <option value="Sugestão">Sugestão</option>
                            <option value="Elogio">Elogio</option>
                        </select>
                    </div>
                    <div>
                        <label for="report-description" class="block font-semibold mb-1 text-slate-700">Descrição do Relato <span class="text-red-500">*</span></label>
                        <p class="text-sm text-slate-500 mb-2">Descreva a situação com o máximo de detalhes possível (o quê, quem, quando, onde, como). Não inclua informações pessoais aqui se desejar permanecer anônimo.</p>
                        <textarea id="report-description" rows="6" required class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent"></textarea>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-bold text-primary">Identificação (Opcional)</h3>
                        <p class="text-sm text-slate-600 mb-3">Preencha os campos abaixo apenas se desejar se identificar. Seus dados serão mantidos em sigilo pela Ouvidoria.</p>
                        <div>
                            <label for="report-name" class="block font-semibold mb-1 text-slate-700">Seu Nome</label>
                            <input type="text" id="report-name" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                        </div>
                        <div class="mt-3">
                            <label for="report-email" class="block font-semibold mb-1 text-slate-700">Seu E-mail</label>
                            <input type="email" id="report-email" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                        </div>
                    </div>
                </div>
                <div class="mt-8 flex justify-end gap-4">
                    <button type="button" class="px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors" onclick="toggleModal('report-modal')">Cancelar</button>
                    <button type="submit" class="px-6 py-2 bg-secondary text-white font-bold rounded-lg hover:bg-primary transition-colors">Enviar Relato</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-sm p-8 relative transform transition-all scale-95 opacity-0">
             <button class="absolute top-4 right-4 text-slate-500 hover:text-red-500" onclick="toggleModal('login-modal')">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h2 class="text-2xl font-bold text-primary mb-6 text-center">Acesso Restrito</h2>
            <form id="login-form">
                <label for="password" class="block font-semibold mb-1 text-slate-700">Senha</label>
                <input type="password" id="password" required class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                <p id="login-error" class="text-red-500 text-sm mt-2 hidden">Senha incorreta. Tente novamente.</p>
                <button type="submit" class="w-full mt-6 px-6 py-3 bg-secondary text-white font-bold rounded-lg hover:bg-primary transition-colors">Entrar</button>
            </form>
        </div>
    </div>

    <!-- Admin Details Modal -->
    <div id="details-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-8 relative transform transition-all scale-95 opacity-0">
            <button class="absolute top-4 right-4 text-slate-500 hover:text-red-500" onclick="toggleModal('details-modal')">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            <h2 class="text-2xl font-bold text-primary mb-6">Detalhes do Relato</h2>
            <div id="details-content" class="space-y-4">
                <!-- Details will be inserted by JS -->
            </div>
            <div class="mt-6 border-t pt-6">
                <h3 class="font-bold text-primary mb-2">Gerenciar Status</h3>
                <input type="hidden" id="details-report-id">
                <select id="details-status-select" class="w-full sm:w-1/2 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent">
                    <option value="Recebido">Recebido</option>
                    <option value="Em Análise">Em Análise</option>
                    <option value="Concluído">Concluído</option>
                </select>
            </div>
             <div class="mt-8 flex justify-end gap-4">
                <button type="button" class="px-6 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors" onclick="toggleModal('details-modal')">Fechar</button>
                <button id="save-status-btn" type="button" class="px-6 py-2 bg-secondary text-white font-bold rounded-lg hover:bg-primary transition-colors">Salvar Alterações</button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg hidden transform transition-all translate-y-20 opacity-0">
        <p id="toast-message"></p>
    </div>


    <!-- ======================================================= -->
    <!-- =================== JAVASCRIPT ====================== -->
    <!-- ======================================================= -->

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, doc, getDoc, updateDoc, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB6lYQHHWvDzQEq4BWBKs0HIuavvWysqk0",
            authDomain: "ouvidoriasucessorh.firebaseapp.com",
            projectId: "ouvidoriasucessorh",
            storageBucket: "ouvidoriasucessorh.firebasestorage.app",
            messagingSenderId: "49858759404",
            appId: "1:49858759404:web:e37c4b5cea3b9dd2cb33c9",
            measurementId: "G-M9SBW7QTRX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const reportsCollection = collection(db, 'ouvidoria_relatos');

        // --- GLOBAL STATE ---
        let allReports = [];

        // --- UI ELEMENTS ---
        const ouvidoriaView = document.getElementById('ouvidoria-view');
        const adminView = document.getElementById('admin-view');
        const reportsTableBody = document.getElementById('reports-table-body');
        const searchInput = document.getElementById('search-input');
        const statusFilter = document.getElementById('status-filter');

        // --- UTILITY FUNCTIONS ---
        const showToast = (message, isError = false) => {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.className = toast.className.replace(/bg-green-500|bg-red-500/, isError ? 'bg-red-500' : 'bg-green-500');
            
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.remove('translate-y-20', 'opacity-0');
            }, 10);

            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
                setTimeout(() => toast.classList.add('hidden'), 500);
            }, 3000);
        };

        window.toggleModal = (modalId) => {
            const modal = document.getElementById(modalId);
            const modalBox = modal.querySelector('div[class*="bg-white"]');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modalBox.classList.remove('scale-95', 'opacity-0');
                }, 10);
            } else {
                modalBox.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }
        };

        const formatDate = (timestamp) => {
            if (!timestamp || !timestamp.toDate) return 'Data indisponível';
            return timestamp.toDate().toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        };

        const getStatusBadge = (status) => {
            switch (status) {
                case 'Recebido':
                    return `<span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${status}</span>`;
                case 'Em Análise':
                    return `<span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${status}</span>`;
                case 'Concluído':
                    return `<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${status}</span>`;
                default:
                    return `<span class="bg-slate-100 text-slate-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${status}</span>`;
            }
        };

        // --- REPORT HANDLING ---
        document.getElementById('report-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitButton = e.target.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.textContent = 'Enviando...';

            try {
                const docRef = await addDoc(reportsCollection, {
                    type: document.getElementById('report-type').value,
                    description: document.getElementById('report-description').value,
                    name: document.getElementById('report-name').value || 'Anônimo',
                    email: document.getElementById('report-email').value || 'Anônimo',
                    status: 'Recebido',
                    createdAt: serverTimestamp()
                });

                showToast(`Relato enviado com sucesso! Protocolo: ${docRef.id}`);
                e.target.reset();
                toggleModal('report-modal');
            } catch (error) {
                console.error("Error adding document: ", error);
                showToast('Erro ao enviar o relato. Tente novamente.', true);
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar Relato';
            }
        });

        // --- ADMIN PANEL LOGIC ---
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('login-error');

            if (password === 'OuvidorRH@2025') {
                errorMsg.classList.add('hidden');
                toggleModal('login-modal');
                ouvidoriaView.classList.add('hidden');
                adminView.classList.remove('hidden');
                fetchAndRenderReports();
            } else {
                errorMsg.classList.remove('hidden');
            }
        });
        
        document.getElementById('logout-btn').addEventListener('click', () => {
            adminView.classList.add('hidden');
            ouvidoriaView.classList.remove('hidden');
            document.getElementById('password').value = '';
        });

        const fetchAndRenderReports = async () => {
            reportsTableBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-slate-500">Carregando relatos...</td></tr>`;
            try {
                const q = query(reportsCollection, orderBy('createdAt', 'desc'));
                const querySnapshot = await getDocs(q);
                allReports = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderTable();
            } catch (error) {
                console.error("Error fetching reports: ", error);
                reportsTableBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-red-500">Erro ao carregar os relatos.</td></tr>`;
            }
        };

        const renderTable = () => {
            const searchTerm = searchInput.value.toLowerCase();
            const status = statusFilter.value;

            const filteredReports = allReports.filter(report => {
                const matchesSearch = searchTerm === '' || 
                    report.id.toLowerCase().includes(searchTerm) ||
                    report.description.toLowerCase().includes(searchTerm) ||
                    report.type.toLowerCase().includes(searchTerm);
                
                const matchesStatus = status === '' || report.status === status;

                return matchesSearch && matchesStatus;
            });
            
            if (filteredReports.length === 0) {
                reportsTableBody.innerHTML = `<tr><td colspan="5" class="p-8 text-center text-slate-500">Nenhum relato encontrado.</td></tr>`;
                return;
            }

            reportsTableBody.innerHTML = filteredReports.map(report => `
                <tr class="border-b border-slate-200 hover:bg-slate-50">
                    <td class="p-4 text-sm font-mono text-slate-500" title="${report.id}">${report.id.substring(0, 8)}...</td>
                    <td class="p-4">${report.type}</td>
                    <td class="p-4">${formatDate(report.createdAt)}</td>
                    <td class="p-4">${getStatusBadge(report.status)}</td>
                    <td class="p-4">
                        <button class="view-details-btn bg-secondary text-white px-3 py-1 rounded-md text-sm hover:bg-primary" data-id="${report.id}">
                            Ver Detalhes
                        </button>
                    </td>
                </tr>
            `).join('');
        };
        
        searchInput.addEventListener('input', renderTable);
        statusFilter.addEventListener('change', renderTable);
        
        reportsTableBody.addEventListener('click', async (e) => {
            if (e.target.classList.contains('view-details-btn')) {
                const reportId = e.target.dataset.id;
                try {
                    const docRef = doc(db, "ouvidoria_relatos", reportId);
                    const docSnap = await getDoc(docRef);

                    if (docSnap.exists()) {
                        const report = docSnap.data();
                        const detailsContent = document.getElementById('details-content');
                        detailsContent.innerHTML = `
                            <p><strong>Protocolo:</strong> <span class="font-mono text-sm">${docSnap.id}</span></p>
                            <p><strong>Data:</strong> ${formatDate(report.createdAt)}</p>
                            <p><strong>Tipo:</strong> ${report.type}</p>
                            <p><strong>Status Atual:</strong> ${getStatusBadge(report.status)}</p>
                            <div class="mt-4 pt-4 border-t">
                                <h4 class="font-bold text-primary">Identificação</h4>
                                <p><strong>Nome:</strong> ${report.name}</p>
                                <p><strong>Email:</strong> ${report.email}</p>
                            </div>
                            <div class="mt-4 pt-4 border-t">
                                <h4 class="font-bold text-primary">Descrição do Relato</h4>
                                <p class="bg-slate-50 p-3 rounded-md whitespace-pre-wrap">${report.description}</p>
                            </div>
                        `;
                        document.getElementById('details-report-id').value = docSnap.id;
                        document.getElementById('details-status-select').value = report.status;
                        toggleModal('details-modal');
                    } else {
                        showToast("Relato não encontrado.", true);
                    }
                } catch (error) {
                    console.error("Error fetching document details:", error);
                    showToast("Erro ao buscar detalhes do relato.", true);
                }
            }
        });

        document.getElementById('save-status-btn').addEventListener('click', async (e) => {
            const reportId = document.getElementById('details-report-id').value;
            const newStatus = document.getElementById('details-status-select').value;
            const button = e.target;
            button.disabled = true;
            button.textContent = 'Salvando...';

            try {
                const reportRef = doc(db, "ouvidoria_relatos", reportId);
                await updateDoc(reportRef, {
                    status: newStatus
                });
                showToast("Status atualizado com sucesso!");
                toggleModal('details-modal');
                fetchAndRenderReports(); // Refresh table
            } catch (error) {
                console.error("Error updating status: ", error);
                showToast("Erro ao atualizar o status.", true);
            } finally {
                button.disabled = false;
                button.textContent = 'Salvar Alterações';
            }
        });


        // --- PAGE LOAD INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            // Modal Buttons
            document.getElementById('open-report-modal-btn').addEventListener('click', () => toggleModal('report-modal'));
            document.getElementById('open-login-modal-btn').addEventListener('click', () => toggleModal('login-modal'));

            // Scroll animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.reveal').forEach(el => {
                observer.observe(el);
            });
        });
    </script>
</body>
</html>
